import Table from './Table';
import { Canvas, Meta, Story } from '@storybook/addon-docs';
import withMock from 'storybook-addon-mock';
import { action } from '@storybook/addon-actions';
import payableMock from '../fixtures/getPayables';

<Meta
  title="Payables/Payables — Table View"
  component={Table}
  decorators={[withMock]}
  parameters={{
    mockData: [
      {
        url: 'https://api.dev.monite.com/v1/payables?limit=10',
        method: 'GET',
        status: 200,
        response: payableMock.firstPage,
      },
      {
        url: 'https://api.dev.monite.com/v1/payables?limit=10&pagination_token=:pagination_token',
        method: 'GET',
        status: 200,
        response: (request) => {
          switch (request.searchParams.pagination_token) {
            case 'next_page':
              return payableMock.secondPage;
            case 'prev_page':
              return payableMock.firstPage;
          }
        },
      },
    ],
  }}
/>

export const Template = (args) => <div style={{ display: 'flex', height: 600 }}><Table {...args} /></div>;

# Payables Table

#### The Payables table is a component for displaying the list of payables for the current entity user.

It displays
- Invoice #
- Supplier’s name
- Invoice date
- Due date
- Status
- Amount

It has several sorting columns: Due date, Amount. First click set up ASC order, second — DESC order, third — disable sorting. Only one sort column could be active at a time.

It has a search field. It sends a request after a user types a search string. Currently, API does not have a full-text search, so the search field looks through invoice numbers only, and it should be an exact match.

It has the filter by status. The user can select specific status or the 'All statuses' option (it means the same as no selection at all). After every select change, the filter settings will be updated and a new request will be fired with updated values.

It has the Due date and Invoice date filters. It is a date picker. After every date change, the filter settings will be updated and a new request will be fired with updated values.

It has pagination. The user can go to the previous/next page only. The current limit for 1 page is 10 rows.

<Canvas>
  <Story
    name='Playground'
    args={{
      onRowClick: action('onRowClick'),
      onChangeSort: action('onChangeSort'),
      onChangeFilter: action('onChangeFilter')
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>
